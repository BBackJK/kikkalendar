<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <!-- 실제 테스트 하는 css 및 js -->
    <link rel='stylesheet' type='text/css' media='screen' href='./calendar.css'>
    <script src="./calendar.js"></script>


    <!-- modal css 및 js -->
    <link rel='stylesheet' type='text/css' media='screen' href='./sample/modal-add-example/modal.css'>

  </head>
  <body>
    <div>
      <div class="__calendar__container__">
        <div class="__calendar__container__header__">
          <div class="__calendar__button__area__">
            <button type="button">TODAY</button>
          </div>
          <div class="__calendar__select__date__">
            <span class="__current__select__year__">2022</span>
            <span>.</span>
            <span class="__current__select__month__">08</span>
          </div>
          <div class="__calendar__arrow__container__">
            <div class="__calendar__arrow__prev__">
              <i></i>
            </div>
            <div class="__calendar__arrow__next__">
              <i></i>
            </div>
          </div>
        </div>
        <div class="__calendar__container__body__">

          <div class="__calendar__contents__ __type_calendar__">
            <div class="__calendar__contents__header__">
              <div class="__header__day_of_week__">일</div>
              <div class="__header__day_of_week__">월</div>
              <div class="__header__day_of_week__">화</div>
              <div class="__header__day_of_week__">수</div>
              <div class="__header__day_of_week__">목</div>
              <div class="__header__day_of_week__">금</div>
              <div class="__header__day_of_week__">토</div>
            </div>
            <div class="__calendar__contents__body__">
              <div class="__body__day__box__ __prev__">
                <div class="__day__"><span>31</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>1</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>2</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>3</span></div>
              </div>
              <div class="__body__day__box__ __today__">
                <div class="__day__">
                  <span>4</span>
                </div>
                <div class="__event__">
                  <div class="value1 single"><span>이벤트1ㅁㄴㅇㅁㅁㅇㄴㅁㄴㅁㅁ</span></div>
                  <div class="value2 start full"><span>이벤트2</span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>5</span></div>
                <div class="__event__">
                  <div class="value1 empty"><span></span></div>
                  <div class="value2 full"><span></span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>6</span></div>
                <div class="__event__">
                  <div class="value1 empty"><span></span></div>
                  <div class="value2 full"><span></span></div>
                </div>
              </div>

              <div class="__body__day__box__">
                <div class="__day__"><span>7</span></div>
                <div class="__event__">
                  <div class="value1 empty"><span></span></div>
                  <div class="value2 full"><span></span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>8</span></div>
                <div class="__event__">
                  <div class="value1 empty"><span></span></div>
                  <div class="value2 end full"><span></span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>9</span></div>
                <div class="__event__">
                  <div class="value1 start full"><span>9일 이벤트2</span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>10</span></div>
                <div class="__event__">
                  <div class="value1 end full"><span></span></div>
                  <div class="value2 start single"><span>10일 이벤트1</span></div>
                  <div class="value3 start full"><span>10일 이벤트2</span></div>
                </div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>11</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>12</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>13</span></div>
              </div>

              <div class="__body__day__box__">
                <div class="__day__"><span>14</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>15</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>16</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>17</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>18</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>19</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>20</span></div>
              </div>

              <div class="__body__day__box__">
                <div class="__day__"><span>21</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>22</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>23</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>24</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>25</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>26</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>27</span></div>
              </div>

              <div class="__body__day__box__">
                <div class="__day__"><span>28</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>29</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>30</span></div>
              </div>
              <div class="__body__day__box__">
                <div class="__day__"><span>31</span></div>
              </div>
              <div class="__body__day__box__ __next__">
                <div class="__day__"><span>1</span></div>
              </div>
              <div class="__body__day__box__ __next__">
                <div class="__day__"><span>2</span></div>
              </div>
              <div class="__body__day__box__ __next__">
                <div class="__day__"><span>3</span></div>
              </div>
            </div>
          </div>
          <!-- __is_active__ -->
          <div class="__calendar__contents__ __type_info__">
            <div class="__calendar__contents__header__">
              <div class="__calendar__select__day__">2022. 08. 06</div>
              <div class="__calendar__contents__close__"></div>
            </div>
            <div class="__calendar__contents__body__" style="height: 547px;">
            <!-- <div class="__calendar__contents__body__"> -->
              <div class="__contents__body__event__container__">
                <span>이벤트가 없습니다.</span>
              </div>
                
              <ul class="__contents__body__event__container__">
                <li class="__body__event__box__ value1">
                  <input type="checkbox" checked />
                  <i></i>
                  <div class="__title__">이벤트 1</div>
                  <div class="__contents__">
                    <p>2022-08-02 14:00 ~ 2022-08-06 16:00</p>
                    <div>이화진은 바보 멍청이</div>
                  </div>
                </li>
                <li class="__body__event__box__ value2">
                  <input type="checkbox" checked />
                  <i></i>
                  <div class="__title__">이벤트 2</div>
                  <div class="__contents__">
                    <p>2022-08-02 14:00 ~ 2022-08-06 16:00</p>
                    <div>이화진은 바보 멍청이</div>
                  </div>
                </li>
                <li class="__body__event__box__ value3">
                  <input type="checkbox" checked />
                  <i></i>
                  <div class="__title__">이벤트 3</div>
                  <div class="__contents__">
                    <p>2022-08-02 14:00 ~ 2022-08-06 16:00</p>
                    <div>이화진은 바보 멍청이</div>
                  </div>
                </li>
                <li class="__body__event__box__ value1">
                  <input type="checkbox" checked />
                  <i></i>
                  <div class="__title__">이벤트 1</div>
                  <div class="__contents__">
                    <p>2022-08-02 14:00 ~ 2022-08-06 16:00</p>
                    <div>이화진은 바보 멍청이</div>
                  </div>
                </li>
                <li class="__body__event__box__ value2">
                  <input type="checkbox" checked />
                  <i></i>
                  <div class="__title__">이벤트 2</div>
                  <div class="__contents__">
                    <p>2022-08-02 14:00 ~ 2022-08-06 16:00</p>
                    <div>이화진은 바보 멍청이</div>
                  </div>
                </li>   
              </ul>
            </div>
            <div class="__calendar__contents__footer__">
              <!-- <button type="button">+</button> -->
            </div>
          </div>

          <div class="__calendar__contents__ __type_add__ __is_active__">
            <div class="__calendar__contents__header__">
              <div class="__calendar__contents__title__">등록</div>
              <div class="__calendar__contents__close__"></div>
            </div>
            <div class="__calendar__contents__body__"  style="height: 547px;">
              <div class="__calendar__event__register__form__">
                <div class="__form__label__input__">
                  <label for="__form__title__">제목</label>
                  <input type="text" id="__form__title__" placeholder="please input event title..." />
                </div>

                <div class="__form__label__input__">
                  <label for="__form__start__">시작일</label>
                  <input type="date" id="__form__start__" placeholder="please input event start date time..." />
                </div>

                <div class="__form__label__input__">
                  <label for="__form__end__">종료일</label>
                  <input type="date" id="__form__end__" placeholder="please input event end date time..." />
                </div>

                <div class="__form__label__input__">
                  <label for="__form__contents__">내용</label>
                  <textarea placeholder="내용을 입력하세요."
                            name="contents"
                            style="resize: none;"
                            id="__form__contents__"
                    ></textarea>
                </div>

              </div>
            </div>
            <div class="__calendar__contents__footer__">
              <button type="button">SAVE</button>
              <button type="reset">RESET</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div>
      <button type="button" id="addEventModal">add event modal</button>
    </div>

    <div id="my-calendar">
    </div>

    <div class="modal-layer" id="my-modal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-title">이벤트 추가</div>
          <div class="close-btn-wrapper">
            <div class="close" name="close-btn"></div>
          </div>
        </div>
        <form id="register-event-form">
          <div class="modal-contents">
            <div class="register-event-container">
              <table class="type-info">
                <colgroup>
                  <col style="width: 30%" />
                  <col style="width: 70%" />
                </colgroup>
                <thead></thead>
                <tbody>
                  <tr>
                    <th>이벤트명</th>
                    <td>
                      <input type="text" placeholder="이벤트명을 입력해주세요." name="title" required />
                    </td>
                  </tr>
                  <tr>
                    <th>시작일</th>
                    <td>
                      <input type="date" placeholder="시작일을 입력해주세요." name="start" required />
                    </td>
                  </tr>
                  <tr>
                    <th>종료일</th>
                    <td>
                      <input type="date" placeholder="종료일을 입력해주세요." name="end" required />
                    </td>
                  </tr>
                  <tr>
                    <th>내용</th>
                    <td>
                      <textarea placeholder="내용을 입력하세요."
                          name="contents"
                          style="resize: none;"
                      ></textarea>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
          <div class="modal-footer">
            <div class="close-wrapper">
              <button type="submit">저장</button>
              <button type="button" name="close-btn">닫기</button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </body>

  <script>
    (function () {

      const options = {
        
        /**
         * 이벤트 목록 api 관련된 프로퍼티 - javascript fetch api 사용
         * method: method 정의 (default: get)
         * mode : 'no-cors', 'cors' (*default), 'same-origin'
         * credentials: include, same-origin (*default), omit
         * url: 호출할 URL ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: ''>
         * headerOptions: 호출할 때 사용하는 header option ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         * data: request body data ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         */
        // getsFetchInfo: {
        //   method: 'get',
        //   mode: 'cors',
        //   credentials: 'same-origin',
        //   url: 'http://localhost:3000/hello?test=1',
        //   headers: {
        //     'Content-Type': 'application/json' // application/x-www-form-urlencoded
        //   },
        //   body: {},
        //   // successCallbackResponseHandle: function (response) {
        //   //   console.log(response);
        //   // },
        //   failureCallbackResponseHandle: function (error) {
        //     console.log('failure callback');
        //     console.log(error);
        //   },
        //   successCatchResponseHandle: function () {
        //     console.log('success catch!!');
        //   },
        //   failureCatchResponseHandle: function () {
        //     console.log('failure catch');
        //   },
        // },

        /**
         * 이벤트 생성 api 관련된 프로퍼티 - javascript fetch api 사용
         * isFetchEnable: api를 사용할 것인지   <기본값: false>
         * isHandleResponse: api 를 통해 받아온 데이터를 직접 핸들링할 것인지 <기본값: false>
         * url: 호출할 URL ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: ''>
         * headerOptions: 호출할 때 사용하는 header option ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         * data: request body data ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         */
        // getFetchInfo: {
        //   // isFetchEnable: false,
        //   // isHandleResponse: false,
        //   url: '',
        //   headerOptions: {
        //     'Authorization': 'YOUT_ACCESS_TOKEN', // options
        //     'Content-Type': 'application/json' // application/x-www-form-urlencoded
        //   },
        //   data: {},
        //   successCallbackResponseHandle: function (response) {

        //   },
        //   failureCallbackResponseHandle: function (error) {

        //   },
        // },

        /**
         * 이벤트 생성 api 관련된 프로퍼티 - javascript fetch api 사용
         * isFetchEnable: api를 사용할 것인지   <기본값: false>
         * isHandleResponse: api 를 통해 받아온 데이터를 직접 핸들링할 것인지 <기본값: false>
         * url: 호출할 URL ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: ''>
         * headerOptions: 호출할 때 사용하는 header option ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         * data: request body data ( 사용하려면 반드시 [isFetchEnable]를 true 로 설정 ) <기본값: 'Content-Type': 'application/json'>
         */
        // postFetchInfo: {
        //   isFetchEnable: false,
        //   isHandleResponse: false,
        //   url: '',
        //   headerOptions: {
        //     'Authorization': 'YOUT_ACCESS_TOKEN', // options
        //     'Content-Type': 'application/json' // application/x-www-form-urlencoded
        //   },
        //   data: {},
        //   successCallbackResponseHandle: function (response) {

        //   },
        //   failureCallbackResponseHandle: function (error) {

        //   },
        // },

        /**
         * 일 선택 시 이벤트 콜백
         * data :{
         *  date: 선택한 날짜
         *  eventList: 해당 날짜의 속해있는 이벤트 list
         * }
         */
        // callbackOnClickSelectDate: function (data) {
        //   console.log(data);
        // },
        triggerOnClickSelectDate: function () {
          console.log(' trigger select date click event ');
        },

        /**
         * 이전 달 화살표 클릭시 이벤트 캐치
         */
        triggerOnClickMovePrevMonth: function () {
          console.log(myCalendar);
        },

        /**
         * 다음 달 화살표 클릭시 이벤트 캐치
         */
        triggerOnClickMoveNextMonth: function () {
          console.log(myCalendar);
        },

        /**
         * 
         */
      };

      const myCalendar = new CALENDAR('my-calendar', options);

      // modal
      const myModal = document.getElementById('my-modal');

      // open button
      const modalOpenBtn = document.getElementById('addEventModal');

      // close button
      const modalCloseBtnList = myModal.querySelectorAll('[name=close-btn]');

      // form
      const $form = document.getElementById('register-event-form');

      // modal 열기 이벤트
      if (modalOpenBtn) {
        modalOpenBtn.onclick = function (e) {
          resetFormValueByTag($form, 'input');
          resetFormValueByTag($form, 'textarea');
          toggleClass(myModal, 'is-active');
        };
      }

      // modal 닫기 이벤트
      if (modalCloseBtnList && modalCloseBtnList.length) {
        for (let i =0; i < modalCloseBtnList.length ;i++) {
          const modalCloseBtn = modalCloseBtnList[i];
          modalCloseBtn.onclick = function (e) {
            toggleClass(myModal, 'is-active');
          }
        }
      }

      // 모달 외부를 클릭 시 모달 닫기 이벤트
      document.addEventListener('click', function (e) {
        if (e.target.classList.contains('modal-layer')) {
          toggleClass(myModal, 'is-active');
        }
      });
      

      // 클래스 토글 이벤트
      function toggleClass(e, className) {
        if (e && e.classList) {
          if (e.classList.contains(className)) {
            e.classList.remove(className);
          } else {
            e.classList.add(className);
          }
        }
      }

      // form value 초기화 
      const resetFormValueByTag = function (formEl, tagName) {
        if (formEl) {
          const $tagList = formEl.querySelectorAll(tagName);

          for (let i=0; i < $tagList.length; i++) {
            const tag = $tagList[i];

            tag.value = '';
          }
        }
      };

      // 등록 이벤트
      $form.addEventListener('submit', function (e) {
        e.preventDefault();

        const _title = $form.querySelector('[name=title]');
        const _start = $form.querySelector('[name=start]');
        const _end = $form.querySelector('[name=end]');
        const _contents = $form.querySelector('[name=contents]');

        const _titleValue = _title.value;
        const _startValue = _start.value;
        const _endValue = _end.value;
        const _contentsValue = _contents.value;

        if (_endValue < _startValue) {
          alert(' 시작일을 종료일보다 이전 혹은 같게 설정해주세요. ');
          return false;
        }

        const event = {
          id: uuidv4().replace(/\-/gi, ''),
          title: _titleValue,
          start: _startValue,
          end: _endValue,
          contents: _contentsValue,
        };

        myCalendar.addEvent(event);
        toggleClass(myModal, 'is-active');
      });

      // uuid generates
      function uuidv4() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
          var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);
          return v.toString(16);
        });
      }
    })();
  </script>
</html>